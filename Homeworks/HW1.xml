<?xml version="1.0" encoding="utf-8"?>
<!-- Date: 2015-01-27 23:08:56 EST -->
<!-- DocBook XML file generated by Org-mode 7.9.3f Emacs 24 -->
<article xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:lang="en">
  <title>8004 Homework 1</title>
  <info>
    <author>
      <personname>
        <firstname>Nooreen</firstname> <othername></othername> <surname>Dabbish</surname>
      </personname>
      
    </author>
  </info>
<section xml:id="sec-1">
<title>Write out the following models of elementary/intermediate statistical analysis in the matrix form: $$ \mathbf{Y} = \mathbf{X&beta;} +\mathbf{&epsilon;} $$</title>
<section xml:id="sec-1_1">
<title>A one-variable quadratic polynomial regression model</title>
<para>$$y<subscript>i</subscript> = &alpha;<subscript>0</subscript> + &alpha;<subscript>1x</subscript><subscript>i</subscript> + &alpha;<subscript>2</subscript> x<subscript>i</subscript><superscript>2</superscript> + &epsilon;<subscript>i</subscript> \textrm{ for }   (i = 1,2,\ldots,5)$$. 
</para>

<para>
$$\mathbf{y} = \begin{pmatrix} y<subscript>1</subscript> \\ y<subscript>2</subscript> \\ y<subscript>3</subscript>
\\ y<subscript>4\\</subscript> y<subscript>5\end</subscript>{pmatrix},
\mathbf{X}= \begin{pmatrix} 1 &amp; x<subscript>1</subscript> &amp; x<subscript>1</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>2</subscript> &amp; x<subscript>2</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>3</subscript> &amp; x<subscript>3</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>4</subscript> &amp; x<subscript>4</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>5</subscript> &amp; x<subscript>1</subscript><superscript>2</superscript> \end{pmatrix},
\mathbf{&beta;} = \begin{pmatrix} &alpha;<subscript>0</subscript> \\ &alpha;<subscript>1</subscript> \\ &alpha;<subscript>2</subscript>
\end{pmatrix}, 
\mathbf{&epsilon;} = \begin{pmatrix} &epsilon;<subscript>1</subscript> \\ &epsilon;<subscript>2</subscript> \\
&epsilon;<subscript>3</subscript> \\ &epsilon;<subscript>4</subscript> \\ &epsilon;<subscript>5</subscript> \end{pmatrix}$$
</para>

<para>
<emphasis role="bold">y</emphasis> = <emphasis role="bold">X&beta;</emphasis> + <emphasis role="bold">&epsilon;</emphasis>  in this model is therefore:
</para>

<para>
$$\begin{pmatrix} y<subscript>1</subscript> \\ y<subscript>2</subscript> \\ y<subscript>3</subscript>
\\ y<subscript>4\\</subscript> y<subscript>5\end</subscript>{pmatrix} = \begin{pmatrix} 1 &amp; x<subscript>1</subscript> &amp; x<subscript>1</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>2</subscript> &amp; x<subscript>2</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>3</subscript> &amp; x<subscript>3</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>4</subscript> &amp; x<subscript>4</subscript><superscript>2</superscript> \\ 
                            1 &amp; x<subscript>5</subscript> &amp; x<subscript>1</subscript><superscript>2</superscript> \end{pmatrix} \begin{pmatrix} &alpha;<subscript>0</subscript> \\ &alpha;<subscript>1</subscript> \\ &alpha;<subscript>2</subscript>
\end{pmatrix} + \begin{pmatrix} &epsilon;<subscript>1</subscript> \\ &epsilon;<subscript>2</subscript> \\
&epsilon;<subscript>3</subscript> \\ &epsilon;<subscript>4</subscript> \\ &epsilon;<subscript>5</subscript> \end{pmatrix}$$
</para>
</section>

<section xml:id="sec-1_2">
<title>A two-factor ANCOVA model without interactions</title>
<para>$$y<subscript>ijk</subscript> = &mu; + &alpha;<subscript>i</subscript> + &beta;<subscript>j</subscript> + &gamma;(x<subscript>ijk</subscript> - \bar{x}) +
&epsilon;<subscript>ijk</subscript>\,\, \textrm{ for } i= 1, 2,\,j=1,2,\,\textrm{ and }k =1,2.$$
</para>

<para>
This model describes an 8-dimensional data space:
</para>

<para>
$$\mathbf{y} = \begin{pmatrix} y<subscript>111</subscript> \\ y<subscript>112</subscript> \\  y<subscript>121</subscript>
\\ y<subscript>122</subscript> \\ y<subscript>211</subscript> \\ y<subscript>212</subscript> \\ y<subscript>221</subscript> \\ y<subscript>222</subscript>
\end{pmatrix},\, 
\mathbf{&epsilon;} = \begin{pmatrix} &epsilon;<subscript>111</subscript> \\ &epsilon;<subscript>112</subscript> \\  &epsilon;<subscript>121</subscript>
\\ &epsilon;<subscript>122</subscript> \\ &epsilon;<subscript>211</subscript> \\ &epsilon;<subscript>212</subscript> \\ &epsilon;<subscript>221</subscript> \\ &epsilon;<subscript>222</subscript> \end{pmatrix}$$
</para>

<para>
The vector of centered x-values may be calculated as $$\bm{x}<subscript>c</subscript> = (\bm{I}-
\frac{1}{n} \bm{J}) \begin{pmatrix} x<subscript>111</subscript> \\ x<subscript>112</subscript> \\  x<subscript>121</subscript>
\\ x<subscript>122</subscript> \\ x<subscript>211</subscript> \\ x<subscript>212</subscript> \\ x<subscript>221</subscript> \\ x<subscript>222</subscript> \end{pmatrix}
= \begin{pmatrix} x<subscript>111</subscript> -\bar{x} \\ x<subscript>112</subscript> - \bar{x} \\  x<subscript>121</subscript> - \bar{x}
\\ x<subscript>122</subscript> -\bar{x} \\ x<subscript>211</subscript> -\bar{x} \\ x<subscript>212</subscript> -\bar{x}
\\ x<subscript>221</subscript> - \bar{x} \\ x<subscript>222</subscript> -\bar{x} \end{pmatrix}$$
</para>
<para>
The design matrix <emphasis role="bold">X</emphasis>  and regression coefficient vector <emphasis role="bold">&beta;</emphasis> are given by: 
$$\mathbf{X} =
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:09:49 2015
\begin{pmatrix}{}
  1.00 &amp; 1.00 &amp; 0.00 &amp; 1.00 &amp; x<subscript>111</subscript> -\bar{x}\\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 1.00 &amp; x<subscript>112</subscript> -\bar{x} \\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 0.00 &amp; x<subscript>121</subscript> -\bar{x}\\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 0.00 &amp; x<subscript>122</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 1.00 &amp; x<subscript>211</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 1.00 &amp; x<subscript>212</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 0.00 &amp; x<subscript>221</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 0.00 &amp; x<subscript>222</subscript> -\bar{x}\\ 
  \end{pmatrix},\,
\mathbf{&beta;} = \begin{pmatrix} &mu; \\ &alpha;<subscript>1</subscript> \\ &alpha;<subscript>2</subscript>
\\ &beta;<subscript>1</subscript> \\ &beta;<subscript>2</subscript> \\ &gamma; \end{pmatrix}$$
</para>

<para>
Putting these together gives the model:
$$\begin{pmatrix} y<subscript>111</subscript> \\ y<subscript>112</subscript> \\  y<subscript>121</subscript>
\\ y<subscript>122</subscript> \\ y<subscript>211</subscript> \\ y<subscript>212</subscript> \\ y<subscript>221</subscript> \\ y<subscript>222</subscript>
\end{pmatrix} =  
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:09:49 2015
\begin{pmatrix}{}
  1.00 &amp; 1.00 &amp; 0.00 &amp; 1.00 &amp; x<subscript>111</subscript> -\bar{x}\\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 1.00 &amp; x<subscript>112</subscript> -\bar{x} \\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 0.00 &amp; x<subscript>121</subscript> -\bar{x}\\ 
  1.00 &amp; 1.00 &amp; 0.00 &amp; 0.00 &amp; x<subscript>122</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 1.00 &amp; x<subscript>211</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 1.00 &amp; x<subscript>212</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 0.00 &amp; x<subscript>221</subscript> -\bar{x}\\ 
  1.00 &amp; 0.00 &amp; 1.00 &amp; 0.00 &amp; x<subscript>222</subscript> -\bar{x}\\ 
  \end{pmatrix}
\begin{pmatrix} &mu; \\ &alpha;<subscript>1</subscript> \\ &alpha;<subscript>2</subscript>
\\ &beta;<subscript>1</subscript> \\ &beta;<subscript>2</subscript> \\ &gamma; \end{pmatrix} + 
\begin{pmatrix} &epsilon;<subscript>111</subscript> \\ &epsilon;<subscript>112</subscript> \\  &epsilon;<subscript>121</subscript>
\\ &epsilon;<subscript>122</subscript> \\ &epsilon;<subscript>211</subscript> \\ &epsilon;<subscript>212</subscript> \\ &epsilon;<subscript>221</subscript> \\ &epsilon;<subscript>222</subscript> \end{pmatrix}$$
</para>
</section>
</section>

<section xml:id="sec-2">
<title>Use eigen() function in R to compute the eigenvalues and eigenvectors of</title>
<para>
$$\mathbf{V}=
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:28:16 2015
\begin{pmatrix}{}
    3 &amp;  -1 &amp;   1 \\ 
   -1 &amp;   5 &amp;  -1 \\ 
    1 &amp;  -1 &amp;   3 \\ 
  \end{pmatrix}
$$
</para>

<para>
Then use R to find and "inverse square root" of this matrix.
That is, find a symmetric matrix $\mathbf{W}$ such that
$\mathbf{WW}=\mathbf{V}<superscript>-1</superscript>$.
</para>
<section xml:id="sec-2_1">
<title>Eigenvalues and Eigenvectors</title>
<para>
The eigenvalues are \bm{&lambda;} = \begin{pmatrix} &lambda;<subscript>1</subscript>
\\ &lambda;<subscript>2</subscript> \\ &lambda;<subscript>3</subscript> \end{pmatrix} =
\begin{pmatrix}{}
    5 \\ 
    2 \\ 
    1 \\ 
  \end{pmatrix}.
</para>

<para>
With corresponding eigenvectors:
$$\mathbf{e<subscript>1</subscript>} = 
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:52:05 2015
\begin{pmatrix}{}
  0.41 \\ 
  -0.82 \\ 
  0.41 \\ 
  \end{pmatrix},\,
\mathbf{e<subscript>2</subscript>} =
% latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:52:05 2015
\begin{pmatrix}{}
  0.58 \\ 
  0.58 \\ 
  0.58 \\ 
  \end{pmatrix},\,
\mathbf{e<subscript>3</subscript>} =
% latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 13:52:05 2015
\begin{pmatrix}{}
  0.71 \\ 
  0.00 \\ 
  -0.71 \\ 
  \end{pmatrix}.
$$
</para>
</section>

<section xml:id="sec-2_2">
<title>Inverse Square Root</title>
<para>
$$\mathbf{W} = 
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 14:47:29 2015
\begin{pmatrix}{}
  0.3889 &amp; 0.0556 &amp; -0.1111 \\ 
  0.0556 &amp; 0.2222 &amp; 0.0556 \\ 
  -0.1111 &amp; 0.0556 &amp; 0.3889 \\ 
  \end{pmatrix}$$
</para>
</section>
</section>

<section xml:id="sec-3">
<title>Consider the matrices</title>
<para>
$$\mathbf{A} = 
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 00:58:30 2015
\begin{pmatrix}{}
  4.00 &amp; 4.00 \\ 
  4.00 &amp; 4.00 \\ 
  \end{pmatrix}\,\textrm{ and }\mathbf{B} =
 % latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 00:58:30 2015
\begin{pmatrix}{}
  4.00 &amp; 4.00 \\ 
  4.00 &amp; 4.00 \\ 
  \end{pmatrix}.$$
</para>

<para>
Obviously, these matrices are nearly identical. Use R and compute the
determinants and inverses of these matrices. (Even though the
original two matrices are nearly the same, $\mathbf{A}<superscript>-1</superscript> &asymp;
-3\mathbf{B}<superscript>-1</superscript>$. This shos that small changes in the elements of
nearly singular matrices can have big eggects on some matrix
operations.)
</para>
<section xml:id="sec-3_1">
<title>Determinants and Inverses.</title>
<para>
The determinant of A is -1.00000000513756e-06
and the determinant of B is SRC<subscript>R[</subscript>:session <emphasis role="bold">hw1</emphasis> :results
raw]{det(B)}.
</para>

<para>
##
</para>

<para>
$$\mathbf{A}<superscript>-1</superscript> = 
% Mon Jan 26 14:52:44 2015
\begin{pmatrix}{}
  -4001999.98 &amp; 4000999.98 \\ 
  4000999.98 &amp; -3999999.98 \\ 
  \end{pmatrix}\, \textrm{ and }\, 
\mathbf{B}<superscript>-1</superscript>  =
\begin{pmatrix}{}
  1334000.33 &amp; -1333666.67 \\ 
  -1333666.67 &amp; 1333333.33 \\ 
  \end{pmatrix}$$
</para>

<para>
#$$ -3\mathbf{B}<superscript>-1</superscript> = 
\begin{pmatrix}{}
  -4002001.00 &amp; 4001000.00 \\ 
  4001000.00 &amp; -4000000.00 \\ 
  \end{pmatrix}$$
</para>
</section>
</section>

<section xml:id="sec-4">
<title>Write an R function to conduct projection, e.g. with the name project().</title>
<para>The input is the given design matrix $\mathbf{X}$, and the output is
the projection matrix $\mathbf{P<subscript>X</subscript>}$ for projecting a vector onto the
column space of $\mathbf{X}$.
</para>
<programlisting><![CDATA[projection <- function (X) {X%*%(solve(t(X)%*%X))%*%t(X)}
]]></programlisting>
</section>

<section xml:id="sec-5">
<title>Consider the (non-full-rank) two-way "effect model" with interactions in the Example (d) in lecture.</title>
<section xml:id="sec-5_1">
<title>Determine which of the parametric functions below are estimable:</title>
<para>
&alpha;<subscript>1</subscript>,&alpha;<subscript>2</subscript> - &alpha;<subscript>a</subscript>, &mu; + &alpha;<subscript>1</subscript>+ &beta;<subscript>1</subscript>+&delta;<subscript>11</subscript>,
&delta;<subscript>12</subscript>, &delta;<subscript>12</subscript> - &delta;<subscript>11</subscript> - (&delta;<subscript>22</subscript> - &delta;<subscript>21</subscript>)
</para>

<para>
For those that are estimable, find $\mathbf{C}<superscript>T</superscript>
(\mathbf{X}<superscript>T</superscript>\mathbf{X})<superscript>-</superscript>\mathbf{X}<superscript>T</superscript>$, such that  $\mathbf{C}<superscript>T</superscript>
(\mathbf{X}<superscript>T</superscript>\mathbf{X})<superscript>-</superscript>\mathbf{X}<superscript>T</superscript>\mathbf{Y}$ procudes the
extimate os $\mathbf{C}<superscript>T</superscript>\mathbf{&beta;}$.
</para>
</section>

<section xml:id="sec-5_2">
<title>For thte parameter vector &beta; written in the order used in class, consider the hypothesis $H<subscript>0</subscript>$ : $\mathbf{C&beta;} = \mathbf{0} for</title>
<para>
$$\mathbf{C} =
% latex table generated in R 3.0.2 by xtable 1.7-4 package
% Mon Jan 26 08:36:22 2015
\begin{pmatrix}{}
    0 &amp;   1 &amp;  -1 &amp;   0 &amp;   0 &amp;   0 &amp;   0 &amp;   0 &amp;   0 \\ 
    0 &amp;   0 &amp;   0 &amp;   0 &amp;   0 &amp;   1 &amp;  -1 &amp;  -1 &amp;   1 \\ 
  \end{pmatrix}$$
</para>

<para>
Is this hypothesis testable? Explain.
</para>
</section>
</section>
</article>
